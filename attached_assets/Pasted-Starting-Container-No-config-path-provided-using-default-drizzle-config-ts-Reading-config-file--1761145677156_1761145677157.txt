Starting Container
No config path provided, using default 'drizzle.config.ts'
Reading config file '/app/drizzle.config.ts'
Using 'pg' driver for database querying
[â£·] Pulling schema from database...
[â£¯] Pulling schema from database...
[â£Ÿ] Pulling schema from database...
[â¡¿] Pulling schema from database...
[â¢¿] Pulling schema from database...
[â£»] Pulling schema from database...
[â£½] Pulling schema from database...
[â£·] Pulling schema from database...
[â£¯] Pulling schema from database...
[â£Ÿ] Pulling schema from database...
[â¡¿] Pulling schema from database...
[â¢¿] Pulling schema from database...
[â£»] Pulling schema from database...
[â£½] Pulling schema from database...
[â£·] Pulling schema from database...
[âœ“] Pulling schema from database...
[âœ“] Changes applied
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.js
  âœ“ use_sandbox
  âœ“ enable_online_payments
Adding SMAX columns...
  âœ“ merchant_provider
  âœ“ merchant_account_id
  âœ“ merchant_api_key
  âœ“ merchant_api_pin
  âœ“ merchant_name
  âœ“ merchant_type
Twilio SMS service initialized
âœ… All required environment variables are present
ğŸ”„ Running database migrations...
Adding USAePay columns...
  âœ“ smax_enabled
  âœ“ smax_api_key
  âœ“ smax_pin
  âœ“ smax_base_url
Adding tenants table service control columns...
  âœ“ is_trial_account
  âœ“ email_service_enabled
  âœ“ sms_service_enabled
  âœ“ portal_access_enabled
  âœ“ payment_processing_enabled
Updating subscriptions table structure...
  âœ“ plan_id
  âœ“ approved_by
  âœ“ approved_at
  âœ“ setup_fee_waived
  âœ“ setup_fee_paid_at
  âœ“ requested_by
  âœ“ No tenants needed fixing
Updating SMS campaigns table...
  âœ“ folder_ids column added
  âœ“ status default changed to pending_approval
ğŸ“‹ All tenant_settings columns: allow_settlement_requests, consumer_portal_settings, contact_email, contact_phone, created_at, custom_branding, enable_online_payments, enabled_modules, id, merchant_account_id, merchant_api_key, merchant_api_pin, merchant_name, merchant_provider, merchant_type, privacy_policy, show_documents, show_payment_plans, smax_api_key, smax_base_url, smax_enabled, smax_pin, sms_throttle_limit, tenant_id, terms_of_service, updated_at, use_sandbox
âœ… Verified new columns: merchant_api_key, merchant_api_pin, smax_api_key, smax_enabled
âœ… Database migrations completed successfully
2:51:33 PM [express] serving on port 8080
â° Scheduled tasks configured:
   - Payment processor: Daily at 2:00 AM
   - Automation processor: Every 15 minutes
  âœ“ requested_at
  âœ“ rejection_reason
  âœ“ emails_used_this_period
  âœ“ sms_used_this_period
  âœ“ current_period_start
  âœ“ current_period_end
Fixing trial status for tenants with active subscriptions...
Received Postmark webhook: {
  "MessageID": "1a054340-4de2-46b5-b0da-f4bf97f19f54",
  "Recipient": "tayreed1226@icloud.com",
  "DeliveredAt": "2025-10-22T14:52:13Z",
  "Details": "smtp;250 2.0.0 Ok: queued as 4D928C0014F",
  "Tag": "campaign-37ab2433-2ffb-4b37-b396-3a7f62c3b2bb",
  "ServerID": 16801401,
  "Metadata": {
    "accountNumber": "25571882",
    "campaignId": "37ab2433-2ffb-4b37-b396-3a7f62c3b2bb",
    "consumerId": "84e81402-aa91-4b25-a161-95c6f32a8796",
    "filenumber": "741151",
    "templateId": "9dcc0bc3-025f-445a-9daf-db2f5a6b5532",
    "tenantId": "bc63d182-9691-455a-b372-10dfcad9c11e"
  },
  "RecordType": "Delivery",
  "MessageStream": "outbound"
}
ğŸ“§ Postmark Event Details:
  - RecordType: Delivery
  - MessageID: 1a054340-4de2-46b5-b0da-f4bf97f19f54
  - Tag: campaign-37ab2433-2ffb-4b37-b396-3a7f62c3b2bb
  - Metadata received: {
  "accountNumber": "25571882",
  "campaignId": "37ab2433-2ffb-4b37-b396-3a7f62c3b2bb",
  "consumerId": "84e81402-aa91-4b25-a161-95c6f32a8796",
  "filenumber": "741151",
  "templateId": "9dcc0bc3-025f-445a-9daf-db2f5a6b5532",
  "tenantId": "bc63d182-9691-455a-b372-10dfcad9c11e"
}
  - Extracted campaignId: 37ab2433-2ffb-4b37-b396-3a7f62c3b2bb
  - Extracted tenantId: bc63d182-9691-455a-b372-10dfcad9c11e
Email tracking event: {
  messageId: '1a054340-4de2-46b5-b0da-f4bf97f19f54',
  recipient: 'tayreed1226@icloud.com',
  campaignId: '37ab2433-2ffb-4b37-b396-3a7f62c3b2bb',
  eventType: 'Delivery',
  timestamp: 2025-10-22T14:52:22.741Z,
  metadata: {
    accountNumber: '25571882',
    campaignId: '37ab2433-2ffb-4b37-b396-3a7f62c3b2bb',
    consumerId: '84e81402-aa91-4b25-a161-95c6f32a8796',
    filenumber: '741151',
    templateId: '9dcc0bc3-025f-445a-9daf-db2f5a6b5532',
    tenantId: 'bc63d182-9691-455a-b372-10dfcad9c11e'